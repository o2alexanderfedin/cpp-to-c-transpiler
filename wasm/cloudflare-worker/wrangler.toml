name = "cpptoc-transpiler"
main = "src/index.ts"
compatibility_date = "2025-01-01"

# Module Workers (required for WASM)
[build]
command = "npm run build"

[build.upload]
format = "modules"

[[build.upload.rules]]
type = "CompiledWasm"
globs = ["**/*.wasm"]
fallthrough = true

# Environment variables
[vars]
MAX_SOURCE_SIZE = "100000"  # 100KB
CACHE_TTL = "3600"          # 1 hour

# Optional: KV namespace for caching
# Create KV namespace: wrangler kv:namespace create "CACHE"
# [[kv_namespaces]]
# binding = "CACHE"
# id = "YOUR_KV_NAMESPACE_ID"

# Development overrides
[env.dev]
vars = { MAX_SOURCE_SIZE = "50000", CACHE_TTL = "60" }

# Production configuration
[env.production]
name = "cpptoc-transpiler-prod"
