# Phase 30-01: Transpile Real-World Test Projects

## Objective

Transpile all 5 real-world C++ test projects to C using the transpiler-api-cli tool and organize the output in a mirrored directory structure under `tests/real-world/transpiled/`.

**Why**: Create a comprehensive collection of transpiled real-world projects for validation, testing, and demonstration purposes.

## Context

**Test Projects** (5 total):
- `json-parser/` - Recursive descent JSON parser with RAII, exceptions, templates
- `logger/` - Multi-level logging system with templates, inheritance
- `test-framework/` - Unit test framework with macros, templates, exceptions
- `string-formatter/` - Type-safe string formatting with variadic templates
- `resource-manager/` - Generic resource management with smart pointers, move semantics

**Transpiler Tool**: `build_working/transpiler-api-cli`
- Usage: `transpiler-api-cli <input.cpp> [--json]`
- Output: JSON with `{success, c, h, acsl, diagnostics}`

**Current State**:
- Source projects: `tests/real-world/<project>/`
- Target directory exists: `tests/real-world/transpiled/` (partially populated)
- Each project has: `src/*.cpp`, `include/*.h`, `tests/*.cpp`, `CMakeLists.txt`

**Expected Structure**:
```
tests/real-world/transpiled/
├── json-parser/
│   ├── src/          # Transpiled .c files
│   ├── include/      # Transpiled .h files
│   ├── tests/        # Transpiled test .c files
│   ├── CMakeLists.txt
│   └── README.md
├── logger/
│   └── ...
├── resource-manager/
│   └── ...
├── string-formatter/
│   └── ...
└── test-framework/
    └── ...
```

## Tasks

### Task 1: Create transpilation script
**Type**: Implementation
**Files**: `scripts/transpile-real-world.sh`
**Action**:
- Create bash script to transpile all 5 test projects
- **First step**: Clean target directory - remove all existing transpiled files from `tests/real-world/transpiled/` (keeping only .gitkeep if needed)
- For each project, find all `.cpp` files in `src/`, `include/`, and `tests/`
- Invoke `build_working/transpiler-api-cli <file.cpp> --json` for each file
- Parse JSON output and extract `.c` and `.h` content
- Write transpiled files to `tests/real-world/transpiled/<project>/<dir>/`
- Maintain directory structure (src→src, include→include, tests→tests)
- Log all transpilation results (success/failures) to `test-logs/transpile-real-world.log`
- Generate summary report with LOC counts, success rates

**Verify**:
- ✅ Script exists at `scripts/transpile-real-world.sh`
- ✅ Script is executable (`chmod +x`)
- ✅ Script processes all 5 projects
- ✅ Maintains directory structure in output

**Done**: Script created, tested with one project successfully

---

### Task 2: Execute transpilation for all projects
**Type**: Execution
**Files**: All `.cpp` files in test projects
**Action**:
- Run `scripts/transpile-real-world.sh`
- Monitor output for errors or failures
- Ensure all source files are transpiled (expect ~50+ files total)
- Verify transpiled files are written to correct locations
- Check that both `.c` and `.h` files are generated
- Review diagnostics for any critical errors

**Verify**:
- ✅ All 5 projects have transpiled output in `tests/real-world/transpiled/`
- ✅ Directory structure mirrors source projects
- ✅ All `.cpp` files have corresponding `.c` files
- ✅ All header files have corresponding `.h` files (if modified)
- ✅ Log file shows transpilation summary
- ✅ Success rate >= 90% (some failures acceptable for unsupported features)

**Done**: All projects transpiled, log shows results

---

### Task 3: Create CMakeLists.txt for transpiled projects
**Type**: Implementation
**Files**: `tests/real-world/transpiled/<project>/CMakeLists.txt` (5 files)
**Action**:
- For each transpiled project, create a CMakeLists.txt
- Configure to build transpiled C code (not C++)
- Set C99 standard (`-std=c99`)
- Include runtime directory: `-I${PROJECT_SOURCE_DIR}/runtime`
- Include project include directory: `-I${CMAKE_CURRENT_SOURCE_DIR}/include`
- Create executable targets for tests
- Link against C++ runtime if needed (for exception handling, RTTI)

**Verify**:
- ✅ Each transpiled project has CMakeLists.txt
- ✅ CMakeLists.txt uses C99 standard
- ✅ Includes runtime directory
- ✅ Can be configured with `cmake`

**Done**: All CMakeLists.txt created

---

### Task 4: Validate transpiled code compiles
**Type**: Validation
**Files**: All transpiled `.c` files
**Action**:
- For each transpiled project, run:
  ```bash
  cd tests/real-world/transpiled/<project>/build
  cmake ..
  make
  ```
- Log compilation errors/warnings to `test-logs/transpile-compile.log`
- Identify any compilation failures
- Document unsupported features causing failures
- Calculate compilation success rate

**Verify**:
- ✅ At least 3 out of 5 projects compile successfully
- ✅ Compilation errors are documented
- ✅ Log file contains detailed error messages
- ✅ Known unsupported features are identified

**Done**: Compilation attempted, results logged

---

### Task 5: Create documentation
**Type**: Documentation
**Files**:
- `tests/real-world/transpiled/README.md`
- `test-logs/transpile-summary.txt`

**Action**:
- Create README.md in transpiled directory explaining:
  - What these transpiled projects are
  - How they were generated
  - Build instructions
  - Known limitations
- Create summary report with:
  - Total files transpiled
  - Success/failure counts per project
  - LOC statistics
  - Compilation results
  - Known issues and unsupported features

**Verify**:
- ✅ README.md exists and is comprehensive
- ✅ Summary report contains all metrics
- ✅ Documentation is clear and actionable

**Done**: Documentation complete

---

## Verification

**Overall Success Criteria**:
1. ✅ Transpilation script exists and is executable
2. ✅ All 5 projects have transpiled output in correct directory structure
3. ✅ Transpilation success rate >= 90%
4. ✅ At least 3 out of 5 projects compile successfully
5. ✅ Documentation is complete and accurate
6. ✅ All logs and reports generated
7. ✅ No git-tracked build artifacts (add to .gitignore if needed)

**Quality Gates**:
- Script uses robust error handling
- JSON parsing is reliable
- File I/O is safe (check file existence, permissions)
- Directory creation is idempotent
- Logs are timestamped and detailed

## Success Criteria

**Measurable Outcomes**:
- 5 transpiled project directories created
- 50+ files transpiled successfully
- Transpilation success rate: >= 90%
- Compilation success: >= 3 projects
- All documentation complete
- Zero manual intervention required

**Deliverables**:
- `scripts/transpile-real-world.sh` (executable script)
- `tests/real-world/transpiled/<project>/` (5 directories with transpiled code)
- `tests/real-world/transpiled/README.md` (documentation)
- `test-logs/transpile-real-world.log` (transpilation log)
- `test-logs/transpile-compile.log` (compilation log)
- `test-logs/transpile-summary.txt` (summary report)

## Output

Upon completion, create `30-01-SUMMARY.md` with:

**What Was Done**:
- List of all projects transpiled
- Total files processed
- Success/failure counts
- Compilation results per project

**Metrics**:
- Total LOC transpiled
- Transpilation success rate
- Compilation success rate
- Time taken

**Issues Encountered**:
- Any transpilation failures with reasons
- Compilation errors with details
- Unsupported C++ features identified

**Deviations from Plan**:
- Any script modifications needed
- Additional files created
- Known limitations discovered

**Next Steps**:
- Suggested improvements
- Features needing implementation
- Integration with CI/CD

---

**Autonomous Execution**: This plan has no checkpoints and will be executed via subagent with fresh context.

**Estimated Context Usage**: ~30-40% (well within quality threshold)
